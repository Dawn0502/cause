<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Jean Morrison" />

<meta name="date" content="2019-07-10" />

<title>Simulations</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CAUSE: Cauasl Analysis Using Summary Effects</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="ldl_cad.html">Software Tutorial</a>
</li>
<li>
  <a href="simulations.html">Simulations</a>
</li>
<li>
  <a href="gwas_pairs.html">Analyze Pairs of GWAS Traits</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jean997/cause">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Simulations</h1>
<h4 class="author">Jean Morrison</h4>
<h4 class="date">2019-07-10</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-07-24
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>cause/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.4.0.9000). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongobjectspresent"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>Environment:</strong> objects present </a>
</p>
</div>
<div id="strongEnvironmentstrongobjectspresent" class="panel-collapse collapse">
<div class="panel-body">
<p>
The global environment had objects present when the code in the R Markdown file was run. These objects can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment. Use <code>wflow_publish</code> or <code>wflow_build</code> to ensure that the code is always run in an empty environment.
</p>
<p>
The following objects were defined in the global environment when these results were created:
</p>
<table class="table table-condensed table-hover">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Class
</th>
<th style="text-align:left;">
Size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
data
</td>
<td style="text-align:left;">
environment
</td>
<td style="text-align:left;">
56 bytes
</td>
</tr>
<tr>
<td style="text-align:left;">
env
</td>
<td style="text-align:left;">
environment
</td>
<td style="text-align:left;">
56 bytes
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20181014code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20181014)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20181014code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20181014)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomjean997causetree112bcdee0633a4f6d155e402104e1527eca2d19atargetblank112bcdea"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/jean997/cause/tree/112bcdee0633a4f6d155e402104e1527eca2d19a" target="_blank">112bcde</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomjean997causetree112bcdee0633a4f6d155e402104e1527eca2d19atargetblank112bcdea" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    sim_results/
    Ignored:    src/RcppExports.o
    Ignored:    src/cause.so
    Ignored:    src/log_likelihood_functions.o

Untracked files:
    Untracked:  analysis/figure/ldl_cad.Rmd/
    Untracked:  analysis/figure/little_test.Rmd/
    Untracked:  cause.Rcheck/
    Untracked:  docs/cause.bib
    Untracked:  docs/figure/cause_figure_1_standalone.pdf
    Untracked:  gwas_data/
    Untracked:  ll_v7_notes.Rmd
    Untracked:  tests/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/112bcdee0633a4f6d155e402104e1527eca2d19a/analysis/simulations.Rmd" target="_blank">112bcde</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
<td>
smally typo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/b1154146bef8ee5f0a4b1471490734da51ba2f29/docs/simulations.html" target="_blank">b115414</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/6aecf9160dae8320d1281d9d5ae5bf0d1d7e1c78/analysis/simulations.Rmd" target="_blank">6aecf91</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
<td>
change some wording and add extraction code
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/8bbb5162069dbefc21f0fca851275dcfed218a96/docs/simulations.html" target="_blank">8bbb516</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-15
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/86ffddd20efe2d2834dc5b682ada896f97c55bdd/analysis/simulations.Rmd" target="_blank">86ffddd</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-15
</td>
<td>
wflow_publish(c(“analysis/index.Rmd”, “analysis/simulations.Rmd”))
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/1074c6128db95e1abb96fa5697c39ef469e1d266/docs/simulations.html" target="_blank">1074c61</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-12
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/7e3c495fd74213919e52a13d592b057ab27bf30b/analysis/simulations.Rmd" target="_blank">7e3c495</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-11
</td>
<td>
more plotting details
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/aeeacea9a4e3e1032e79a0d1271787aa47c2015d/analysis/simulations.Rmd" target="_blank">aeeacea</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-11
</td>
<td>
lots of plotting details. still working
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/d2f0f741720daa4b2b05f7c7da4d55cdb0cd4a0b/docs/simulations.html" target="_blank">d2f0f74</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-10
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/6c171b2cc9a8d040138d79e1b404a65de9f2b75d/analysis/simulations.Rmd" target="_blank">6c171b2</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-10
</td>
<td>
wflow_publish(“analysis/simulations.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/165f2c81412fee8c44f95eb925b25891fec0d55e/docs/simulations.html" target="_blank">165f2c8</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-09
</td>
<td>
Revert “Build site.”
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/2666541e7075abd688e073d0df535398514855ed/docs/simulations.html" target="_blank">2666541</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/16285d63a5d60c078293c14b16b8ed6df1d09c5a/analysis/simulations.Rmd" target="_blank">16285d6</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-09
</td>
<td>
wflow_publish(“analysis/simulations.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/a1b74c5840b59877e79510e747131457961c9029/docs/simulations.html" target="_blank">a1b74c5</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/31a7da8399e15fed79099247f949411141db4e04/analysis/simulations.Rmd" target="_blank">31a7da8</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-09
</td>
<td>
wflow_publish(“analysis/simulations.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/0dd65ccae04d204000f8e640b175ef011b015839/docs/simulations.html" target="_blank">0dd65cc</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-06-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/b78e77f8d72199464465a98e0b3cfe2a6f9503c5/analysis/simulations.Rmd" target="_blank">b78e77f</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-06-25
</td>
<td>
wflow_publish(files = c(“analysis/simulations.Rmd”))
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jean997/cause/286f4e9e0a432565b96c38bba3a1b155c02f9a78/docs/simulations.html" target="_blank">286f4e9</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-06-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jean997/cause/blob/8f3b82e734b124b6d4d9d28b9defcce8d3726410/analysis/simulations.Rmd" target="_blank">8f3b82e</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-06-25
</td>
<td>
wflow_publish(files = c(“analysis/about.Rmd”, “analysis/index.Rmd”, “analysis/ldl_cad.Rmd”, “analysis/license.Rmd”,
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This page gives instructions for running the simulations that we ran to evaluate CAUSE and will allow you to reproduce the results <a href="https://www.biorxiv.org/content/10.1101/682237v3">the paper</a>. It will hopefully also serve as a resource for explaining those results in more detail and allow you to modify simulations to run your own experiments. There are a lot of parameters that can be changed. We tried to explore a reasonable range of scenarios but there are many more variations that could be tried. Running the simulations involves multiple set-up steps, mostly software installation and may take a bit of time, especially if you are new to DSC. Additionally, completing the simulations requires several hours of computing and needs to be done on a cluster. If you don’t have access to that kind of computing resource you may still find this section useful. All of our results can be downloaded and we will include some discussions of the patterns that we observed as we go along.</p>
</div>
<div id="set-up" class="section level1">
<h1>Set Up</h1>
<div id="software-installation" class="section level2">
<h2>Software Installation</h2>
<p>Simulations are run using the <code>causeSims</code> R package. The package can be installed with</p>
<pre><code>devtools::install_github(&quot;jean997/causeSims&quot;)</code></pre>
<p>This package relies on a few R packages that are not on CRAN, which you will need to install separately. For detailed installation instructions including installation of supporting R packages for other methods see <a href="https://github.com/jean997/causeSims">here</a>. There you can also find a walk through of a single simulation and explanations of the functions contained in the package.</p>
<p>We conduct simulations using the <a href="https://stephenslab.github.io/dsc-wiki/overview">Dynamical Statisical Comparisons</a> software. You will need to <a href="https://stephenslab.github.io/dsc-wiki/installation.html">have DSC installed</a> and it will be helpful to take a look at <a href="https://stephenslab.github.io/dsc-wiki/first_course/Intro_DSC">the tutorial</a> if you haven’t used DSC before.</p>
</div>
<div id="set-up-the-analysis-directory" class="section level2">
<h2>Set Up The Analysis Directory</h2>
<p>To set up the analysis create a working directory that you will run the simulations in. Make sure all the software in the previous section is installed.</p>
<p>From inside this working directory use the R command</p>
<pre class="r"><code>library(causeSims)
setup_sims()</code></pre>
<p>This function downloads the following files:</p>
<ul>
<li><p>LD data: This is used for simulating summary statistics and is placed into a sub-directory <code>data</code>. The LD data are downloaded from <a href="https://zenodo.org/record/3235780/">here</a> and contain data for HapMap3 SNPs on chromosome 19 estimated from the CEU 1000 Genomes samples.</p></li>
<li><p>DSC files: These contain instructions for DSC on how to simulate data and analyze it. Jump to <a href="#details">this subsection</a> for a detailed description of the DSC files and simulation parameters. If you want to run your own experiments, these files should provide a good starting place for that. The set up function downloads three DSC files. One is for evaluating false positives in the presence of different levels of correlated pleiotropy, one is for evaluating power when there is a true causal effect, and one is for evaluating the robustness of CAUSE to different prior distributions on <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\eta\)</span> (see supplementary note of the paper).</p></li>
<li><p>A configuration file for running DSC on a cluster. This file is set up for the University of Chicago Research Computing Cluster so you will need to change it to match your cluster set up. Even if you are using the U of C cluster, you will need to change the home directory and account lines of this file. Read about using DSC with a compute cluster <a href="https://stephenslab.github.io/dsc-wiki/advanced_course/Remote_Computations">here</a> (We are using the “On Host” option) and modify <code>config.yml</code> as needed.</p></li>
<li><p>Some code for plotting and results summarization</p></li>
</ul>
</div>
</div>
<div id="run-dsc" class="section level1">
<h1>Run DSC</h1>
<p>To run DSC use the following commands at the command line</p>
<pre><code>nohup dsc --replicate 100 --host config.yml -c 4 power.dsc &gt; pwr_dsc.out &amp;
nohup dsc --replicate 100 --host config.yml -c 4 false_positives.dsc &gt; fp_dsc.out &amp;
nohup dsc --replicate 100 --host config.yml -c 4 sigma_g.dsc &gt; sg_dsc.out &amp;</code></pre>
<p>Depending on your computing resources and how many jobs you allow to run simultaneously, this could take several hours for each command. Errors can occur that stop DSC, usually a result of interfacing with the cluster. For example, DSC may fail to detect that a job has completed. If this happens, simply restart the failed job using the same command. DSC will pick up where it left off since all results are saved along the way. Running these commands will generate lots of <code>*.err</code> and <code>*.out</code> files all of which can be safely deleted. Results will be in directories named <code>fp</code> (false positives), <code>pwr</code> (power) and <code>sigma_g</code> (results for testing the prior on <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\eta\)</span>).</p>
</div>
<div id="look-at-results-and-plot-them" class="section level1">
<h1>Look at Results and Plot Them</h1>
<div id="false-positive-and-power-results" class="section level2">
<h2>False positive and power results</h2>
<p>The script <code>extract_results_main.R</code> will use the <code>dscrutils</code> package to extract results from the false positive and power analyses. If you are modifying the analysis and have changed the names of the output directories, you will need to change them in this file also. Depending on the changes you have made, you may need to make other modifications. Read more about <a href="https://stephenslab.github.io/dsc-wiki/first_course/Intro_DSC.html#query-the-results">dscrutils here</a> and in the <code>dscrutils</code> documentation. This script will save R objects containing CAUSE, LCV, and other MR method results for both analyses. It will append the date so it won’t over-write the results downloaded by <code>setup_sims()</code>. Run it at the command line using</p>
<pre><code>Rscript extract_results_main.R</code></pre>
<p>or from inside R using <code>source(extract_results_main.R)</code>. It will take several minutes to extract all of the results. If you would like to use your own files to plot, change the file names in the code below which uses the downloaded results.</p>
<pre class="r"><code>library(tidyverse)
library(gridExtra)
library(pROC)
library(jcolors)</code></pre>
<p>The results extraction script makes a data frame for CAUSE results and a data frame for all the other MR methods. There is also a data frame for results from LCV but this is discussed later on. We first read in results and look around a little</p>
<pre class="r"><code>causedf &lt;- readRDS(&quot;sim_results/main_causedf.RDS&quot;)
dim(causedf)</code></pre>
<pre><code>[1] 6400   26</code></pre>
<pre class="r"><code>head(causedf)</code></pre>
<pre><code>  DSC simulate.output.file  tau     gamma q omega eta   h1   h2    n1
1   1  simulate/simulate_1 0.00 0.0000000 0     0   0 0.25 0.25 12000
2   1  simulate/simulate_2 0.01 0.1000000 0     0   0 0.25 0.25 12000
3   1  simulate/simulate_3 0.02 0.1414214 0     0   0 0.25 0.25 12000
4   1  simulate/simulate_4 0.03 0.1732051 0     0   0 0.25 0.25 12000
5   1  simulate/simulate_5 0.04 0.2000000 0     0   0 0.25 0.25 12000
6   1  simulate/simulate_6 0.05 0.2236068 0     0   0 0.25 0.25 12000
     n2 neffect1 neffect2 lcv_q1 lcv_q2 gcp m_sig     params
1 12000     1000     1000      0      0   0    10    (0,0,0)
2 12000     1000     1000      1      0   1     5 (0.01,0,0)
3 12000     1000     1000      1      0   1     7 (0.02,0,0)
4 12000     1000     1000      1      0   1     8 (0.03,0,0)
5 12000     1000     1000      1      0   1    15 (0.04,0,0)
6 12000     1000     1000      1      0   1     6 (0.05,0,0)
                        cause.output.file    cause.p cause.eta_sharing
1 cause/simulate_1_cause_params_1_cause_1 1.00000000       0.011931561
2 cause/simulate_2_cause_params_1_cause_1 0.99999998       0.002510281
3 cause/simulate_3_cause_params_1_cause_1 0.17667815       0.130967317
4 cause/simulate_4_cause_params_1_cause_1 0.09319743       0.275080972
5 cause/simulate_5_cause_params_1_cause_1 0.13777660       0.201534222
6 cause/simulate_6_cause_params_1_cause_1 0.03422957       0.285438995
  cause.q_sharing cause.eta_causal cause.q_causal cause.gamma_causal
1      0.04109263    -0.0038530765     0.04901066         0.00479154
2      0.04354778    -0.0170810260     0.05051196         0.00754432
3      0.06559798    -0.0003402543     0.04756247         0.08344094
4      0.16287869    -0.0070851343     0.05040652         0.12319126
5      0.11645133    -0.0099462311     0.04614923         0.08230970
6      0.14942537     0.0079122698     0.04220322         0.13940896
                      tag
1 pwr_simulate/simulate_1
2 pwr_simulate/simulate_2
3 pwr_simulate/simulate_3
4 pwr_simulate/simulate_4
5 pwr_simulate/simulate_5
6 pwr_simulate/simulate_6</code></pre>
<p>The frist 18 columns of the data frame are all simulation parameters, information about the simulation files, or simple statistics computed about the simulated data. These include</p>
<ul>
<li><code>gamma</code>, <code>eta</code>, <code>q</code>: True values of <span class="math inline">\(\gamma\)</span>, <span class="math inline">\(\eta\)</span> and <span class="math inline">\(q\)</span> used to simulate data. <code>params</code> gives a character string listing <span class="math inline">\((\gamma, \eta, q)\)</span>.</li>
<li><code>tau</code>, <code>omega</code>: Transformations of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\eta\)</span> respectively. <span class="math inline">\(\tau\)</span> is the proportion of <span class="math inline">\(Y\)</span> heritability explained by the causal effect of trait <span class="math inline">\(M\)</span>, equal to <span class="math inline">\(\tau = \gamma^2 h^2_{M}/h^2_Y\)</span>. In our case <span class="math inline">\(h^2_M = h^2_Y\)</span> for all simulations so <span class="math inline">\(\tau = \gamma^2\)</span>. <span class="math inline">\(\omega\)</span> is defined as <span class="math inline">\(\omega = \eta^2 h^2_M/h^2_Y = \eta^2\)</span>.</li>
<li><code>h1</code>, <code>h2</code>: Heritabilitites for trait <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> respectively <code>h1</code> $ = h^2_M$ and <code>h2</code><span class="math inline">\(= h^2_Y\)</span>. In our case these are equal to 0.25 for all simulations.</li>
<li><code>n1</code>, <code>n2</code>: Sample size for GWAS of traits <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> respectively. These can be equal to 12,000 (low power) or 40,000 (high power).</li>
<li><code>neffect</code>, <code>neffect2</code>: Expected number of effect SNPS for trait <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span>. In our case equal to 1000 for all simulations.</li>
<li><code>lcv_q1</code>, <code>lcv_q2</code>, <code>gcp</code>: True values of the LCV parameters <span class="math inline">\(q_1\)</span>, <span class="math inline">\(q_2\)</span> and GCP. These are computed from <span class="math inline">\(\gamma\)</span>, <span class="math inline">\(\eta\)</span> and <span class="math inline">\(q\)</span>.</li>
<li><code>m_sig</code>: The number of genome-wide significant variants for trait <span class="math inline">\(M\)</span> after pruning for LD using an threshold of <span class="math inline">\(r^2 &lt; 0.1\)</span></li>
</ul>
<p>Values extracted from the CAUSE results all begin with <code>cause.</code>. For example, <code>cause.p</code> is the CAUSE <span class="math inline">\(p\)</span>-value. Posterior medians for <span class="math inline">\(\gamma\)</span>, <span class="math inline">\(\eta\)</span> and <span class="math inline">\(q\)</span> are reported for the sharing and causal models (e.g. <code>cause.q_causal</code> is the posterior median of <span class="math inline">\(q\)</span> in the causal model).</p>
<p>The <code>mrdf</code> data frame gives results for alternative MR methods. The first 18 columns are the same as in the <code>causedf</code> data frame. For these methods, we have extracted only the method name (in the <code>mr</code> column) and the <span class="math inline">\(p\)</span>-value (<code>mr.p</code>).</p>
<pre class="r"><code>mrdf &lt;- readRDS(&quot;sim_results/main_mrdf.RDS&quot;)
dim(mrdf)</code></pre>
<pre><code>[1] 32000    21</code></pre>
<pre class="r"><code>head(mrdf)</code></pre>
<pre><code>  DSC simulate.output.file  tau gamma q omega eta   h1   h2    n1    n2
1   1  simulate/simulate_1 0.00   0.0 0     0   0 0.25 0.25 12000 12000
2   1  simulate/simulate_1 0.00   0.0 0     0   0 0.25 0.25 12000 12000
3   1  simulate/simulate_1 0.00   0.0 0     0   0 0.25 0.25 12000 12000
4   1  simulate/simulate_1 0.00   0.0 0     0   0 0.25 0.25 12000 12000
5   1  simulate/simulate_1 0.00   0.0 0     0   0 0.25 0.25 12000 12000
6   1  simulate/simulate_2 0.01   0.1 0     0   0 0.25 0.25 12000 12000
  neffect1 neffect2 lcv_q1 lcv_q2 gcp m_sig     params    mr      mr.p
1     1000     1000      0      0   0    10    (0,0,0)   ivw 0.9043105
2     1000     1000      0      0   0    10    (0,0,0) egger 0.9970743
3     1000     1000      0      0   0    10    (0,0,0)   mrp 0.9043105
4     1000     1000      0      0   0    10    (0,0,0)    wm 0.2693825
5     1000     1000      0      0   0    10    (0,0,0)  gsmr 0.8497915
6     1000     1000      1      0   1     5 (0.01,0,0)   ivw 0.5163502
                      tag
1 pwr_simulate/simulate_1
2 pwr_simulate/simulate_1
3 pwr_simulate/simulate_1
4 pwr_simulate/simulate_1
5 pwr_simulate/simulate_1
6 pwr_simulate/simulate_2</code></pre>
<pre class="r"><code>with(mrdf, table(mr))</code></pre>
<pre><code>mr
egger  gsmr   ivw   mrp    wm 
 6400  6400  6400  6400  6400 </code></pre>
<p>We first summarize results grouping by sample size and simulation setting. Some of the MR methods will have missing results if there are too few variants. We consider this as not having rejected the null hypothesis or a non-significant result. CAUSE does not have any missing results.</p>
<pre class="r"><code>cause_summ &lt;- causedf %&gt;% 
              group_by(q, tau, omega,  n1, n2) %&gt;%
              summarize(n_sig = sum(cause.p &lt; 0.05, na.rm=T),
                        missing = sum(is.na(cause.p))) %&gt;% 
              mutate(analysis = &quot;cause&quot;)

mr_summ &lt;- mrdf %&gt;%
           group_by(q, tau, omega,  n1, n2, mr) %&gt;%
           summarize(n_sig = sum(mr.p &lt; 0.05, na.rm=T),
                     missing = sum(is.na(mr.p))) %&gt;%
           rename(analysis = &quot;mr&quot;)


res &lt;- bind_rows(cause_summ, mr_summ) %&gt;%
        ungroup() %&gt;%
        mutate(label = fct_recode(analysis, &quot;CAUSE&quot;=&quot;cause&quot;,
                                     &quot;Egger&quot; = &quot;egger&quot;, &quot;GSMR&quot;=&quot;gsmr&quot;,
                                     &quot;IVW&quot;=&quot;ivw&quot;, 
                                     &quot;MR-PRESSO&quot;=&quot;mrp&quot;, &quot;Wtd. Median&quot; = &quot;wm&quot;),
                 n1 = factor(paste0(&quot;N[M]==&quot;, n1)),
                 n2 = factor(paste0(&quot;N[Y]==&quot;, n2)))

filter(res, analysis==&quot;cause&quot;) %&gt;% with(., all(missing == 0))</code></pre>
<pre><code>[1] TRUE</code></pre>
<div id="power" class="section level3">
<h3>Power</h3>
<p>Now we can plot!</p>
<p>First we plot power with <span class="math inline">\(\tau\)</span> on the horizontal axis and the number of times each method rejected the null hypothesis on the vertical axis.</p>
<pre class="r"><code>#colors
cc &lt;- as.character(jcolors(&quot;default&quot;))
cols &lt;- c(cc[3], cc[1:2], cc[4:5],  &quot;#D590DA&quot;)
#plot
pwr &lt;- res %&gt;%
       filter(tau != 0 | (tau == 0 &amp; omega == 0 &amp; q == 0)) %&gt;% #This line includes only the power simulations. 
       ggplot(.) + 
          geom_line(aes(x=tau, y=n_sig/100, color=label)) +  
          geom_point(aes(x=tau, y=n_sig/100, color=label, shape=label)) +
          scale_color_manual(values=cols) + 
          scale_shape_manual(values= c(16, 3, 4, 0, 2, 6:8)) +
          geom_hline(yintercept=0.05, linetype=2) +
          xlab(expression(&quot;Percentage of Y heritability explained by M (&quot; ~ tau ~ &quot;=&quot; ~ gamma^2 ~ h[M]^2/h[Y]^2 ~ &quot;)&quot;)) +
          ylab(&quot;Percent Significant&quot;) + 
          theme_bw() + 
          theme(legend.title = element_blank(), 
                strip.text = element_text(size=14),
                axis.title = element_text(size=16),
                legend.text = element_text(size=12),
                legend.position = &quot;bottom&quot;) +  
          guides(color=guide_legend(nrow=1),  
                 linetype=guide_legend(nrow=1),
                 shape=guide_legend(nrow=1) )  + 
          facet_wrap(~n1*n2, nrow=2, labeller = label_parsed)

pwr</code></pre>
<p><img src="figure/simulations.Rmd/plot_power-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot_power-1">
Past versions of plot_power-1.png
</button>
</p>
<div id="fig-plot_power-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jean997/cause/blob/b1154146bef8ee5f0a4b1471490734da51ba2f29/docs/figure/simulations.Rmd/plot_power-1.png" target="_blank">b115414</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>CAUSE has lower power than the other methods except when the power for trait <span class="math inline">\(M\)</span> is low and the power for trait <span class="math inline">\(Y\)</span> is high. This is expected since CAUSE uses a more stringent criterion to conclude that the data are consistent with a causal effect. It is able to achieve better power when <span class="math inline">\(M\)</span> is under-powered and <span class="math inline">\(Y\)</span> is well powered because it uses all variants genome-wide rather than only those that are highly significant for trait <span class="math inline">\(M\)</span>. This is an important setting because it may be applicable to scenarios when <span class="math inline">\(M\)</span> is a biomarker or molecular trait and <span class="math inline">\(Y\)</span> is a complex triat.</p>
</div>
<div id="false-positives" class="section level3">
<h3>False Positives</h3>
<p>Next we plot false positives. Our simulations include two values of <span class="math inline">\(\eta\)</span> (<span class="math inline">\(\sqrt{0.05}\)</span> and <span class="math inline">\(\sqrt{0.02}\)</span>). Although we only had space to present one set of results in the paper, we will make plots for both here. We plot the proportion of <span class="math inline">\(M\)</span> effect variants that display correlated pleiotropy, <span class="math inline">\(q\)</span>, on the horizontal axis and the number of discoveries on the vertical axis. The bottom row of plots are for the larger value of <span class="math inline">\(\eta\)</span> and are the ones shown in the paper. For convenience, in extracting results, we copy the results for <span class="math inline">\(q=0\)</span>.</p>
<pre class="r"><code>z1 &lt;-  filter(res, omega == 0 &amp; tau == 0 &amp; q == 0) %&gt;% mutate(omega = 0.05)
z2 &lt;-  filter(res, omega == 0 &amp; tau == 0 &amp; q == 0) %&gt;% mutate(omega = 0.02)
res2 &lt;- bind_rows(res, z1, z2) %&gt;%
        filter(!(q == 0 &amp; omega == 0 &amp; tau == 0))</code></pre>
<pre class="r"><code>fp &lt;- res2 %&gt;%
      filter(tau == 0) %&gt;%
      ggplot(.) +
        geom_line(aes(x=q, y=n_sig/100, color=label)) +
        geom_point(aes(x=q, y=n_sig/100, color=label, shape=label)) +
        geom_hline(yintercept=0.05, linetype=2) +
        scale_color_manual(values=cols) +
        scale_shape_manual(values= c(16, 3, 4, 0, 2, 6:8)) +
        geom_hline(yintercept=0.05, linetype=2) +
        xlab(&quot;Proportion of variants acting through U (q)&quot;) +
        ylab(&quot;Percent Significant&quot;) +
        theme_bw() +
        theme(legend.title = element_blank(),
            strip.text = element_text(size=14),
            axis.title = element_text(size=16),
            legend.text = element_text(size=12),
            legend.position = &quot;bottom&quot;) +
        guides(color=guide_legend(nrow=1),
             linetype=guide_legend(nrow=1),
             shape=guide_legend(nrow=1) )  +
        facet_wrap(~omega*n1*n2, nrow=2, labeller=label_parsed)

fp</code></pre>
<p><img src="figure/simulations.Rmd/plot_fp-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot_fp-1">
Past versions of plot_fp-1.png
</button>
</p>
<div id="fig-plot_fp-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jean997/cause/blob/b1154146bef8ee5f0a4b1471490734da51ba2f29/docs/figure/simulations.Rmd/plot_fp-1.png" target="_blank">b115414</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In all cases CAUSE has a lower false positive rate than alternative methods. The false positive rate increases for large values of <span class="math inline">\(q\)</span> and is worse when the effect of the shared factor is stronger.</p>
</div>
<div id="roc-curves" class="section level3">
<h3>ROC Curves</h3>
<p>We use ROC curves to evaluate how well each method is able to distinguish simulations with a causal effect of size <span class="math inline">\(\gamma = \sqrt{0.05}\)</span> from simulations with a shared factor with an equal effect acconting for 30% of the trait <span class="math inline">\(M\)</span> vairants. Both of these parameters can be modified. The first step is to combine the CAUSE and alternative MR results into a single data frame</p>
<pre class="r"><code>x1 &lt;- causedf %&gt;%
      mutate(analysis = &quot;cause&quot;, stat = -log10(cause.p)) %&gt;%
      select(tag, q, omega, tau, n1, n2, analysis, stat)

x2 &lt;- mrdf %&gt;%
      mutate(stat = -log10(mr.p)) %&gt;%
      rename(analysis = mr) %&gt;%
      select(tag, q, omega, tau, n1, n2, analysis, stat)

full_results &lt;- bind_rows(x1, x2)

full_results &lt;- full_results %&gt;% 
                mutate(label = fct_recode(analysis, &quot;CAUSE&quot;=&quot;cause&quot;,
                                     &quot;Egger&quot; = &quot;egger&quot;, &quot;GSMR&quot;=&quot;gsmr&quot;,
                                     &quot;IVW&quot;=&quot;ivw&quot;,
                                     &quot;MR-PRESSO&quot;=&quot;mrp&quot;, &quot;Wtd. Median&quot; = &quot;wm&quot;))</code></pre>
<p>Next we use the <code>pROC</code> package.</p>
<pre class="r"><code>eff &lt;- 0.05
my_q &lt;- 0.3
n1s &lt;- c(12000, 12000, 40000, 40000)
n2s &lt;- c(12000, 40000, 12000, 40000)

methods &lt;- with(full_results, unique(label)) %&gt;%
            as.vector(.)

cc &lt;- as.character(jcolors(&quot;default&quot;))
cols &lt;- c(cc[3], cc[1:2], cc[4:5],  &quot;#D590DA&quot;)


roc_df &lt;-lapply(seq_along(n1s), function(i){
                    my_n1 &lt;- n1s[i]
                    my_n2 &lt;- n2s[i]
                    rocs &lt;- lapply(methods, function(m){
                       #cat(m, &quot; &quot;)
                       xx &lt;- filter(full_results, n1 == my_n1 &amp; n2 == my_n2 &amp; label == m &amp;
                                 ( tau == eff | (omega == eff &amp; q == my_q &amp; tau == 0)))
                       xx$stat[is.na(xx$stat)] &lt;- 0
                       with(xx, roc(predictor = stat, response = tau !=0)) %&gt;%
                            with(., data.frame(thresh = thresholds, spec = specificities,
                                            sens = sensitivities, method = m,
                                            n1 = my_n1, n2 = my_n2,
                                            stringsAsFactors=F)) %&gt;% 
                            return()

                })
                do.call(rbind, rocs)
            })
roc_df &lt;- do.call(rbind, roc_df) %&gt;%
          mutate(n1 = factor(paste0(&quot;N[M]==&quot;, n1)),
                 n2 = factor(paste0(&quot;N[Y]==&quot;, n2)))
head(roc_df)</code></pre>
<pre><code>        thresh spec sens method          n1          n2
1         -Inf 0.00    1  CAUSE N[M]==12000 N[Y]==12000
2 1.928655e-16 0.05    1  CAUSE N[M]==12000 N[Y]==12000
3 5.472558e-15 0.06    1  CAUSE N[M]==12000 N[Y]==12000
4 2.472668e-11 0.07    1  CAUSE N[M]==12000 N[Y]==12000
5 5.650660e-11 0.08    1  CAUSE N[M]==12000 N[Y]==12000
6 9.814568e-11 0.09    1  CAUSE N[M]==12000 N[Y]==12000</code></pre>
<pre class="r"><code># A data frame with points to add to the curve
pw &lt;- filter(res, tau == eff ) 
f &lt;- filter(res, omega == eff &amp; q == my_q &amp; tau ==0)
df &lt;- select(pw, label, n_sig, n1, n2) %&gt;%
      rename(power = n_sig) %&gt;%
      full_join(., f, c(&quot;label&quot;, &quot;n1&quot;, &quot;n2&quot;)) %&gt;%
      rename(fp = n_sig) %&gt;%
      select(label, power, fp, n1, n2) %&gt;%
      filter(label %in% methods) %&gt;%
      rename(method=label)

## Plotting!
plt &lt;- roc_df %&gt;% 
       arrange(sens) %&gt;%
       ggplot(.) +
          geom_line(aes(x=1-spec, y=sens, col=method, group=method, linetype=method)) +
          geom_point(aes(x=fp/100, y = power/100, col=method, shape=method), size =4 , data=df) +
          scale_color_manual(values=cols) +
          scale_linetype_manual(values = rep(1, 6)) +
          scale_shape_manual(values = c(rep(16, 6))) +
          xlab(&quot;1 - Specificity (False Positive Rate)&quot;) + ylab(&quot;Sensitivity (Power)&quot;) +
          theme_bw() +
          theme(legend.title = element_blank(),
                strip.text = element_text(size=14),
                axis.title = element_text(size=16),
                legend.text = element_text(size=12),
                legend.position = &quot;bottom&quot;) +
          guides(color=guide_legend(nrow=1),
                 linetype=guide_legend(nrow=1),
                 shape=guide_legend(nrow=1))  +
          facet_wrap(~n1*n2, nrow=2, labeller= label_parsed)
plt</code></pre>
<p><img src="figure/simulations.Rmd/roc_curves-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-roc_curves-1">
Past versions of roc_curves-1.png
</button>
</p>
<div id="fig-roc_curves-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jean997/cause/blob/b1154146bef8ee5f0a4b1471490734da51ba2f29/docs/figure/simulations.Rmd/roc_curves-1.png" target="_blank">b115414</a>
</td>
<td>
Jean Morrison
</td>
<td>
2019-07-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="prior-robustness-results" class="section level2">
<h2>Prior robustness results</h2>
<p>The <code>sigma_g</code> anlaysis is intended to evaluate how sensitive CAUSE is to changes in the prior on <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\eta\)</span>. These parameters have the same <span class="math inline">\(N(0, \sigma_{\gamma, \eta})\)</span> prior distribution. By default, <span class="math inline">\(\sigma_{\gamma \eta}\)</span> is chosen guided by the data. These results dmeonstrate that, within a wide range, CAUSE is insensitive to the value of <span class="math inline">\(\sigma_{\gamma \eta}\)</span>.</p>
<p>The R script <code>extract_sigma_g.R</code> will use <code>dscrutils</code> to extract simulation results and store them in a data frame. Run it at the command line with</p>
<pre><code>Rscript extract_sigma_g.R</code></pre>
<p>or from inside an R session using <code>source</code>.</p>
<p>This code will append the date to the file it saves so it won’t save over the results downloaded by <code>setup_sims()</code>. If you want to use your own data frame, change the file name in the commands below.</p>
<pre class="r"><code>causedf &lt;- readRDS(&quot;sim_results/sg_causedf.RDS&quot;)
head(causedf)</code></pre>
<pre><code>  DSC simulate.output.file  tau     gamma q omega eta   h1   h2    n1
1   1  simulate/simulate_1 0.00 0.0000000 0     0   0 0.25 0.25 12000
2   1  simulate/simulate_1 0.00 0.0000000 0     0   0 0.25 0.25 12000
3   1  simulate/simulate_1 0.00 0.0000000 0     0   0 0.25 0.25 12000
4   1  simulate/simulate_2 0.05 0.2236068 0     0   0 0.25 0.25 12000
5   1  simulate/simulate_2 0.05 0.2236068 0     0   0 0.25 0.25 12000
6   1  simulate/simulate_2 0.05 0.2236068 0     0   0 0.25 0.25 12000
     n2 neffect1 neffect2 lcv_q1 lcv_q2 gcp m_sig     params
1 12000     1000     1000      0      0   0    12    (0,0,0)
2 12000     1000     1000      0      0   0    12    (0,0,0)
3 12000     1000     1000      0      0   0    12    (0,0,0)
4 12000     1000     1000      1      0   1     9 (0.05,0,0)
5 12000     1000     1000      1      0   1     9 (0.05,0,0)
6 12000     1000     1000      1      0   1     9 (0.05,0,0)
                                cause_sigma_g.output.file quant   sigma_g
1 cause_sigma_g/simulate_1_cause_params_1_cause_sigma_g_1  0.51 8.9197112
2 cause_sigma_g/simulate_1_cause_params_1_cause_sigma_g_2  0.65 0.5803009
3 cause_sigma_g/simulate_1_cause_params_1_cause_sigma_g_3  0.80 0.2656855
4 cause_sigma_g/simulate_2_cause_params_1_cause_sigma_g_1  0.51 8.9197112
5 cause_sigma_g/simulate_2_cause_params_1_cause_sigma_g_2  0.65 0.5803009
6 cause_sigma_g/simulate_2_cause_params_1_cause_sigma_g_3  0.80 0.2656855
           z eta_sharing  q_sharing   eta_causal   q_causal gamma_causal
1 -0.5461963 -0.08614480 0.03227185  0.028694201 0.03801121  -0.03322635
2 -0.4892988 -0.07568029 0.04260754  0.018572988 0.04527922  -0.03298326
3 -0.4297365 -0.05659584 0.05292346  0.007849239 0.05476068  -0.03219930
4  1.4732631  0.27284495 0.16470454 -0.007890599 0.03751927   0.11590717
5  1.6179259  0.26001457 0.17152739 -0.003179130 0.04402581   0.11544675
6  1.5826705  0.22719281 0.18457916  0.002465637 0.05338622   0.11385987
           p
1 0.70753449
2 0.68768490
3 0.66630635
4 0.07034006
5 0.05283928
6 0.05674829</code></pre>
<pre class="r"><code>with(causedf, table(sigma_g))</code></pre>
<pre><code>sigma_g
0.265685475321082 0.580300937746447  8.91971124189946 
             1200              1200              1200 </code></pre>
<pre class="r"><code>with(causedf, table(params))</code></pre>
<pre><code>params
     (0,0,0) (0,0.05,0.3)   (0.05,0,0) 
        1200         1200         1200 </code></pre>
<p>The only columns that we have not seen previously are <code>quant</code> and <code>sigma_g</code>. <code>sigma_g</code> gives the value of <span class="math inline">\(\sigma_{\gamma \eta}\)</span> used in each simulation. These are large, medium and small values which are chosen so that <span class="math inline">\(\sqrt{0.05}\)</span> is the 51st, 65th and 80th quantile (<code>quant</code>) of the <span class="math inline">\(N(0, \sigma_{\gamma \eta})\)</span> distribution respectively. In this data frame we have ommited the <code>cause.</code> prefix on columns because CAUSE is the only method we are evaluating.</p>
<p>There are three sets of parameters used in simulations. Below we calculate the correlation in <span class="math inline">\(p\)</span>-value and posterior median for each parameter in each setting across the three values of <span class="math inline">\(\sigma_{\gamma \eta}\)</span>. The following code only reports the minimum correlation for each parameter-simulation setting combination and the correlation between the medium and small values of <span class="math inline">\(\sigma_{\gamma \eta}\)</span>.</p>
<pre class="r"><code>vars &lt;- c(&quot;z&quot;, &quot;p&quot;, &quot;eta_sharing&quot;, &quot;q_sharing&quot;,
          &quot;eta_causal&quot;, &quot;q_causal&quot;, &quot;gamma_causal&quot;)

min_cor &lt;- expand.grid(variable = vars,
                       params = unique(causedf$params), stringsAsFactors=F)
min_cor$min_cor &lt;- NA
min_cor$cor_med_small &lt;- NA
for(i in seq(nrow(min_cor))){
    v &lt;- min_cor$variable[i]
    X &lt;- select(causedf, simulate.output.file, params, quant, one_of(v)) %&gt;%
         spread(quant, get(v))  %&gt;%
         filter(params==min_cor$params[i]) %&gt;%
         select(one_of(c(&quot;0.51&quot;, &quot;0.65&quot;, &quot;0.8&quot;)))

    min_cor$min_cor[i] &lt;- min(cor(X))
    min_cor$cor_med_small[i] &lt;- cor(X[,&quot;0.65&quot;], X[,&quot;0.8&quot;])

}
min_cor</code></pre>
<pre><code>       variable       params   min_cor cor_med_small
1             z      (0,0,0) 0.9413760     0.9488980
2             p      (0,0,0) 0.9916459     0.9939591
3   eta_sharing      (0,0,0) 0.3500210     0.9717212
4     q_sharing      (0,0,0) 0.8413687     0.9872975
5    eta_causal      (0,0,0) 0.3603472     0.9325197
6      q_causal      (0,0,0) 0.7260232     0.9658187
7  gamma_causal      (0,0,0) 0.9989405     0.9994984
8             z   (0.05,0,0) 0.9979358     0.9982020
9             p   (0.05,0,0) 0.9964440     0.9974132
10  eta_sharing   (0.05,0,0) 0.6521383     0.8758111
11    q_sharing   (0.05,0,0) 0.9996888     0.9998863
12   eta_causal   (0.05,0,0) 0.2743656     0.9163213
13     q_causal   (0.05,0,0) 0.6408410     0.9771773
14 gamma_causal   (0.05,0,0) 0.9994321     0.9997125
15            z (0,0.05,0.3) 0.9659368     0.9721875
16            p (0,0.05,0.3) 0.9971477     0.9976421
17  eta_sharing (0,0.05,0.3) 0.6150360     0.9564461
18    q_sharing (0,0.05,0.3) 0.9949857     0.9987768
19   eta_causal (0,0.05,0.3) 0.6098137     0.9237515
20     q_causal (0,0.05,0.3) 0.7366983     0.9726195
21 gamma_causal (0,0.05,0.3) 0.9987725     0.9994594</code></pre>
<p>This code is also contained in <code>summarize_sigma_g.R</code>.</p>
</div>
</div>
<div id="details" class="section level1">
<h1>What’s in the DSC Files?</h1>
<p>We will now go in detail through one of the DSC files so you can see what is happening and how to make changes to run your own experiments. We will look at <code>false_positives.dsc</code> but <code>power.dsc</code> and <code>sigma_g.dsc</code> are similar.</p>
<p>The DSC statement is at the top:</p>
<pre><code>DSC:
    define:
        mr: ivw, egger, mrp, wm, twas, wm, gsmr
    run: simulate*gw_sig,
         simulate*LCV,
         simulate*mr,
         simulate*cause_params*cause
    replicate: 100
    output: fp</code></pre>
<p>This statement tells DSC what to run. In <code>define</code> we define a group of modules. These will turn up later in the file. In <code>run</code> we tell DSC what to run. For example, <code>simulate*gw_sig</code> means that DSC should run the <code>simulate</code> module followed by the <code>gw_sig</code> module which will use the results of the <code>simulate</code> module. <code>replicate</code> indicates the number of replicates to run (though this is over-ridden by the <code>--replicate</code> flag in the DSC call above) and <code>output</code> names the output directory.</p>
<p>The rest of the document defines modules. All of our modules use R code and most of them rely on the <code>causeSims</code> R package.</p>
<div id="simulation-modules" class="section level2">
<h2>Simulation Modules</h2>
<p>The simulation module:</p>
<pre><code>simulate: R(library(causeSims);
            snps &lt;- readRDS(&quot;data/chr19_snpdata_hm3only.RDS&quot;);
            evd_list &lt;- readRDS(&quot;data/evd_list_chr19_hm3.RDS&quot;);
            dat &lt;- sum_stats(snps, evd_list,
                  n_copies = 30,
                  n1 = n1, n2=n2,
                  h1=h1, h2=h1,
                  neffect1 = neffect1, neffect2 = neffect2,
                  tau = tau, omega = omega, q = q,
                  cores = 4, ld_prune_pval_thresh = 0.01,
                  r2_thresh = 0.1))

     q: 0.1, 0.2, 0.3, 0.4, 0.5
     omega: 0.02, 0.05
     tau: 0
     n1: 12000, 40000
     n2: 12000, 40000
     neffect1: 1000
     neffect2: 1000
     h1: 0.25
     h2: 0.25
     $sim_params: c(q = q, omega = omega, tau = tau,  h1 = h1, h2 = h2, n1 = n1, n2 = n2, neffect1 = neffect1, neffect2 =neffect2)
     $dat: dat</code></pre>
<p>The R code contained in <code>R()</code> is the guts of this module. A data object named <code>dat</code> is generated using the <code>sum_stats</code> function from the <code>causeSims</code> R pacakge. Below this, we specify parameters used to simulate the data. Most important are <code>q</code>, <code>omega</code>, and <code>tau</code>. <code>q</code> is the proportion of variants acting through <span class="math inline">\(U\)</span> while <code>omega</code> and <code>tau</code> are standardized versions of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\eta\)</span> in the paper. <code>tau</code> is the proportion of <span class="math inline">\(Y\)</span> heritability explained by the causal effect of <span class="math inline">\(M\)</span> on <span class="math inline">\(Y\)</span> times the sign of <span class="math inline">\(\gamma\)</span>, <span class="math display">\[
\tau = sign(\gamma)\frac{\gamma^2 h^2_{M}}{h^{2}_{Y}},
\]</span> and <code>omega</code> is the proportion of <span class="math inline">\(Y\)</span> heritability explained by <span class="math inline">\(U\)</span>, divided by <span class="math inline">\(q\)</span> and multiplied by the sign of <span class="math inline">\(\eta\)</span>. <span class="math display">\[
\omega = sign(\eta)\frac{\eta^2 h^2_{M}}{h^{2}_{Y}}
\]</span> This parameterization is sometimes more convenient for running simulations that using <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\gamma\)</span>. However, the <code>sum_stats</code> function will accept either <code>omega</code> and <code>tau</code> arguments or <code>eta</code> and <code>gamma</code>. Note that here we have specified that the function can use 4 cores. This should match the <code>n_cpu</code> parameter in the <code>simulate</code> section of the config file. The <code>sum_stats</code> function generates data both with and without LD. In this file we only analyze the “with LD” data but we will describe how to make modifications to analyze both or only the “no LD” data.</p>
<p>The <code>gw_sig</code> module is a helper module. This module computes the GCP (a parameter defined by LCV (O’Connor and Price 2019)) and computes the number of genome-wide significant variants. It also stores all the simulation parameters which makes it easier to extract them. Extracting parameters from the <code>simulate</code> module will require reading in the entire data set, objects created by the <code>gw_sig</code> module are smaller and faster to read.</p>
<pre><code>gw_sig: R(library(causeSims);
           m_sig_nold &lt;- with($(dat), sum(p_value_nold &lt; thresh ));
           y_sig_nold &lt;- with($(dat), sum(2*pnorm(-abs(beta_hat_2_nold/seb2)) &lt; thresh ));
           m_sig &lt;- with($(dat), sum(p_value &lt; thresh &amp; ld_prune==TRUE));

          params &lt;- $(sim_params);
          tau &lt;- as.numeric(params[&quot;tau&quot;]);
          omega &lt;- as.numeric(params[&quot;omega&quot;]);
          q &lt;- as.numeric(params[&quot;q&quot;]);
          h1 &lt;- as.numeric(params[&quot;h1&quot;]);
          h2 &lt;- as.numeric(params[&quot;h2&quot;]);
          neffect1 &lt;- as.numeric(params[&quot;neffect1&quot;]);
          neffect2 &lt;- as.numeric(params[&quot;neffect2&quot;]);
          gamma &lt;- sqrt(tau*sum(h2)/sum(h1))*sign(tau);
          eta &lt;- sqrt(abs(omega)*sum(h2)/sum(h1))*sign(omega);

          #LCV parameters
          if(q == 0 &amp; tau == 0){
            q.1 &lt;- q.2 &lt;- 0;
            gcp &lt;- 0;
          }else if(q == 0){
            q.1 &lt;- 1;
            q.2 &lt;- 0;
            gcp &lt;- 1;
          }else{
            q.1 &lt;- sqrt(q);
            q.2 &lt;- eta * sqrt(q) * sqrt(h1) / sqrt(h2);
            gcp = (log(q.2^2) - log(q.1^2)) / (log(q.2^2) + log(q.1^2));
          };
          gcp_mom &lt;- gcp_moments($(dat), h1, h2)
          )
    thresh: 5e-8
    $m_sig: m_sig
    $m_sig_nold: m_sig_nold
    $y_sig_nold: y_sig_nold
    $q: q
    $omega: omega
    $tau: tau
    $gamma: gamma
    $eta: eta
    $h1: h1
    $h2: h2
    $n1: as.numeric(params[&quot;n1&quot;])
    $n2: as.numeric(params[&quot;n2&quot;])
    $neffect1: as.numeric(params[&quot;neffect1&quot;])
    $neffect2: as.numeric(params[&quot;neffect2&quot;])
    $lcv_q1: q.1
    $lcv_q2: q.2
    $lcv_gcp: gcp
    $lcv_gcp_mom: gcp_mom$gcp</code></pre>
</div>
<div id="cause-modules" class="section level2">
<h2>CAUSE Modules</h2>
<p>We have divided CAUSE analysis into parameter estimation and model fitting steps. This makes it easier to experiment with changes only to the parameter estimation step.</p>
<pre><code>cause_params: R(library(causeSims);
                p1 &lt;- cause_params_sims($(dat), null_wt = null_wt, no_ld=FALSE);
                )
    null_wt: 10
    $cause_params_ld: p1

cause: R(library(causeSims);
         library(cause);
         cause_res &lt;- cause_sims($(dat), $(cause_params_ld), no_ld = FALSE);
         z &lt;- -1*summary(cause_res)$z;
         p &lt;- pnorm(-z);
         quants &lt;- summary(cause_res)$quants)
    $cause_res: cause_res
    $sigma_g: cause_res$sigma_g
    $eta_med_2: quants[[1]][1,2]
    $q_med_2: quants[[1]][1,3]
    $eta_med_3: quants[[2]][1,2]
    $gamma_med_3: quants[[2]][1,1]
    $q_med_3: quants[[2]][1,3]
    $z: z
    $p: p</code></pre>
<p>Both modules use wrapper functions from the <code>causeSims</code> package. These are very simple wrappers that make it easy to run CAUSE on the simulated data format. Note that here we use <code>no_ld = FALSE</code> in both modules. If you want to use the data that is simulated without LD instead you can change <code>no_ld = TRUE</code>. You could get results for both using the following set of modules.</p>
<pre><code>cause_params: R(library(causeSims);
                p1 &lt;- cause_params_sims($(dat), null_wt = null_wt, no_ld=FALSE);
                p2 &lt;- cause_params_sims($(dat), null_wt = null_wt, no_ld=TRUE);
                )
    null_wt: 10
    $cause_params_ld: p1
    $cause_params_nold: p2

cause: R(library(causeSims);
         library(cause);
         if(no_ld==FALSE){
          cause_res &lt;- cause_sims($(dat), $(cause_params_ld), no_ld = no_ld);
         else{
          cause_res &lt;- cause_sims($(dat), $(cause_params_nold), no_ld = no_ld);
         }
         z &lt;- -1*summary(cause_res)$z;
         p &lt;- pnorm(-z);
         quants &lt;- summary(cause_res)$quants)
    $no_ld: TRUE, FALSE
    $cause_res: cause_res
    $sigma_g: cause_res$sigma_g
    $eta_med_2: quants[[1]][1,2]
    $q_med_2: quants[[1]][1,3]
    $eta_med_3: quants[[2]][1,2]
    $gamma_med_3: quants[[2]][1,1]
    $q_med_3: quants[[2]][1,3]
    $z: z
    $p: p</code></pre>
</div>
<div id="alternative-mr-modules" class="section level2">
<h2>Alternative MR Modules</h2>
<p>There are many modules for alternative MR methods. Modules for IVW regression, Egger regression, MR-PRESSO, and the weighted median method are very similar and rely on wrappers from <code>causeSims</code>. We can just look at one of these.</p>
<pre><code>ivw: R(library(causeSims);
       res &lt;- ivw($(dat), p_val_thresh=thresh, no_ld = no_ld);
       )
    thresh: 5e-8
    no_ld: FALSE
    $z: res$z
    $p: res$p</code></pre>
<p>To run on the data without LD change the <code>no_ld</code> parameter to <code>no_ld: TRUE</code> or <code>no_ld: TRUE, FALSE</code> to run both.</p>
<p>The GSMR module is a little more complicated</p>
<pre><code>gsmr: R(library(causeSims);
        evd_list &lt;- readRDS(&quot;data/evd_list_chr19_hm3.RDS&quot;);
        res &lt;- gsmr_sims($(dat), evd_list, p_val_thresh  = 5e-8, no_ld = FALSE);
        if(!is.null(res)){
           z &lt;- res$bxy/res$bxy_se;
           est &lt;- res$bxy;
           p &lt;- res$bxy_pval;
        }else{
           z &lt;- est &lt;- p &lt;-  NA;
        }
      )
    thresh: 5e-8
    $z: z
    $p: p
    $est_gsmr: est
    $gsmr: res</code></pre>
<p>GSMR requires the LD structure and sometimes returns errors. In this case the <code>gsmr_sims</code> wrapper returns NULL and we set results to missing. If <code>no_ld = TRUE</code> the LD data in <code>evd_list</code> is simply ignored.</p>
</div>
<div id="lcv-module" class="section level2">
<h2>LCV Module</h2>
<p>Results from LCV are not compared with CAUSE in the paper because LCV is performing a different test than other MR methods. However, we have implemented wrappers and a module to run LCV.</p>
<pre><code>LCV: R(library(causeSims);
       res &lt;- try(lcv_sims($(dat),no_ld = no_ld, sig.thresh = thresh));
       if(class(res) == &quot;try-error&quot;){
            res &lt;- list(pval.gcpzero.2tailed=NA, gcp.pm = NA, gcp.pse = NA);
        };
       )
    thresh: 30
    no_ld: FALSE
    $p: res$pval.gcpzero.2tailed
    $gcp_mean: res$gcp.pm
    $gcp_pse: res$gcp.pse
    $gcp_obj: res</code></pre>
<p>When LCV returns errors, we set results to missing.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] jcolors_0.0.4   pROC_1.15.0     gridExtra_2.3   forcats_0.4.0  
 [5] stringr_1.4.0   dplyr_0.8.3     purrr_0.3.2     readr_1.3.1    
 [9] tidyr_0.8.3     tibble_2.1.3    ggplot2_3.2.0   tidyverse_1.2.1

loaded via a namespace (and not attached):
 [1] tidyselect_0.2.5     xfun_0.8             haven_2.1.1         
 [4] lattice_0.20-38      colorspace_1.4-1     generics_0.0.2      
 [7] vctrs_0.2.0          htmltools_0.3.6      yaml_2.2.0          
[10] rlang_0.4.0          pillar_1.4.2         glue_1.3.1          
[13] withr_2.1.2          modelr_0.1.4         readxl_1.3.1        
[16] plyr_1.8.4           munsell_0.5.0        gtable_0.3.0        
[19] workflowr_1.4.0.9000 cellranger_1.1.0     rvest_0.3.4         
[22] evaluate_0.14        labeling_0.3         knitr_1.23          
[25] highr_0.8            broom_0.5.2          Rcpp_1.0.1          
[28] scales_1.0.0         backports_1.1.4      jsonlite_1.6        
[31] fs_1.3.1             hms_0.5.0            digest_0.6.20       
[34] stringi_1.4.3        grid_3.6.1           rprojroot_1.3-2     
[37] cli_1.1.0            tools_3.6.1          magrittr_1.5        
[40] lazyeval_0.2.2       crayon_1.3.4         whisker_0.3-2       
[43] pkgconfig_2.0.2      zeallot_0.1.0        xml2_1.2.0          
[46] lubridate_1.7.4      assertthat_0.2.1     rmarkdown_1.13      
[49] httr_1.4.0           rstudioapi_0.10      R6_2.4.0            
[52] nlme_3.1-140         git2r_0.26.1         compiler_3.6.1      </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
